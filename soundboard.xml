<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<!-- Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy of
 * the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *	
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License
-->
	<ModulePrefs title="Hangout Soundboard">
		<Require feature="rpc" />
		<Require feature="views" />
		<Require feature="locked-domain" />
	</ModulePrefs>
	<Content type="html"><![CDATA[     


<html>
<style type="text/css">
<!--
.button {
  border-radius: 3px;
  -moz-border-radius: 3px;
  background: -webkit-gradient(linear, left top, left bottom, from(#fff), to(#ddd));
  background: -moz-linear-gradient(top, #fff, #ddd);  
  border: 1px solid #bbb;
}

.button:active {
	background: -webkit-gradient(linear, left top, left bottom, from(#aaa), to(#333)); 
	background: -moz-linear-gradient(bottom, #ddd, #aaa); }

-->
</style>
<body>

<script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>

<h3>Hangout Soundboard</h3>

<hr>
<div id="buttonsDiv"></div>

<div id="drop_zone">Drop files here</div>
<output id="list"></output>

<script>
	var retVal = '<p>';
soundNames = ["Roar","Bear","Lightning","Spell 1","Spell 2","Mystic aura","Turn down"];

  for (i = 0; i < soundNames.length; i++) { 
  retVal += '<input class="button" type="button" value="' + soundNames[i] + '" id="' + soundNames[i] + '" '; 
	  retVal += 'onClick="playSound(' + i + ')"/>'
  retVal += '<br><br>';
    }
    retVal += '</p>'
    var div = document.getElementById('buttonsDiv');
    div.innerHTML = retVal;

sounds = []
for (i = 0; i < soundNames.length; i++) { 
  myURL = "http://www.maxradin.com/soundboard/sounds/" + soundNames[i] + ".wav";
  sounds.push(gapi.hangout.av.effects.createAudioResource(
               myURL).createSound({loop: false, localOnly: false}));
	    }

function playSound(i) {
  sounds[i].play();
}

  function handleFileSelect(evt) {
    evt.stopPropagation();
    evt.preventDefault();

    var files = evt.dataTransfer.files; // FileList object.

    // files is a FileList of File objects. List some properties.
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      output.push('<li><strong>', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
                  f.size, ' bytes, last modified: ',
                  f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
                  '</li>');
      var reader = new FileReader();
      reader.onload = function(e){
        sounds[0] = (gapi.hangout.av.effects.createAudioResource(
                     e.target.result).createSound({loop: false, localOnly: false}));
sounds[0].play()
console.log(e.target.result)
      }
      reader.readAsDataURL(f)
    }
    document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
  }

  function handleDragOver(evt) {
    evt.stopPropagation();
    evt.preventDefault();
    evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
  }

  // Setup the dnd listeners.
  var dropZone = document.getElementById('drop_zone');
  dropZone.addEventListener('dragover', handleDragOver, false);
  dropZone.addEventListener('drop', handleFileSelect, false);

function init() {
  // When API is ready...                                                         
}

// Wait for gadget to load.                                                       
gadgets.util.registerOnLoadHandler(init);
</script>
</body>
]]>
</Content>
</Module>

